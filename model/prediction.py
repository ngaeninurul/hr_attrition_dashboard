# -*- coding: utf-8 -*-
"""attrition-predict

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ulVKsZPUFqDl6DxpxUF26m4l998ELLzX

# üè¢ ATTRITION PREDICTION **üö™**

## Import Library
"""

import pandas as pd
import joblib
from sklearn.preprocessing import LabelEncoder

"""## Prediction"""

# Load model dan fitur Random Forest
model = joblib.load("model_prediction.pkl")
features = joblib.load("features_le.pkl")

# Fitur
selected_features = [
      'OverTime', 'JobInvolvement', 'WorkLifeBalance', 'DistanceFromHome', 'HourlyRate', 'JobLevel',
      'YearsAtCompany', 'PercentSalaryHike', 'EnvironmentSatisfaction', 'BusinessTravel', 'JobSatisfaction',
      'StockOptionLevel', 'RelationshipSatisfaction', 'Gender', 'MonthlyRate', 'TotalWorkingYears',
      'DailyRate', 'Age', 'MonthlyIncome', 'YearsSinceLastPromotion', 'EmployeeId', 'Education'
]

categorical_cols = [col for col in ['Gender', 'OverTime', 'BusinessTravel'] if col in selected_features]

# Load data baru
new_data = pd.read_csv("input_prediction.csv")

# Ambil fitur dan label encode
new_X = new_data[selected_features].copy()

for col in categorical_cols:
    le = LabelEncoder()
    new_X[col] = le.fit_transform(new_X[col].astype(str))

# Urutkan kolom berdasarkan urutan saat training
new_X = new_X.reindex(columns=features)

# Predict
predictions = model.predict(new_X)

# Tambahkan hasil
new_data['Attrition_Prediction'] = predictions
new_data['Attrition_Prediction'] = new_data['Attrition_Prediction'].map({1: 'Yes', 0: 'No'})

# Simpan hasil
new_data.to_csv("output_prediction.csv", index=False)
print("Hasil prediksi disimpan ke 'output_prediction.csv'")